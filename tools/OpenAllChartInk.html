<!DOCTYPE html>
<html>
<!--
<body style="background-color:powderblue;" background="img/background.png">
-->
<body style="background-color:powderblue;">
<p style="font-size:110%;" id="messageLink"></p>
<p style="font-size:110%;"> Enter Text : <input type="text" id="stockTicker">
JSON Format: <input type="checkbox" id="jsonFormatCheck">
Text Seperated by Space: <input type="checkbox" id="txtSeperatorSpace">
<button type="button" onclick="mainFunction()">Open ChartInk links</button>
<button type="button" onclick="startOverFunction()">Start Over</button>
Number of charts to open per click : <input type="text" id="stocksToOpenPerClick" spellcheck="false">
</p>

<p id="messageProcessedStocks"></p>
<p id="messageProcessedStocksStats"></p>
<center> <img src="img/background.png" alt="Background pic" > </center>
<script>
var messageLink = document.getElementById("messageLink");
messageLink.innerHTML = "Copy data from: https://www.nseindia.com/products/dynaContent/equities/equities/json/online52NewHigh.json";

totalStocks = 0;
processedStocks = 0;
copyTextNow = 1;
var strStockProcessed = "";
var messageProcessedStocks = document.getElementById("messageProcessedStocks")
var messageProcessedStocksStats = document.getElementById("messageProcessedStocksStats");
document.getElementById("stocksToOpenPerClick").value = 5;
jsonFormat = document.getElementById("jsonFormatCheck");
txtSeperatorSpace = document.getElementById("txtSeperatorSpace");
jsonFormat.checked = true;

function startOverFunction() {	
	totalStocks = 0;
	processedStocks = 0;
	messageProcessedStocks.innerHTML = "";
	strStockProcessed ="";
	messageProcessedStocksStats.innerHTML = "Total stocks: " + totalStocks + " Processed: " + processedStocks
	copyTextNow = 1;
}

function openPage(stock){
	var text = "http://chartink.com/stocks/" + stock + ".html";
	text = text.replace (/"/g,"");
	text = text.replace (/ /g,"");
	console.log(text);
	window.open(text);
}

function mainFunction() {
	var jsonFormat = document.getElementById("jsonFormatCheck");
	if (copyTextNow == 1) {
		var stocks_list = document.getElementById("stockTicker").value;
		if (jsonFormat.checked == true)
			jsonData = JSON.parse(stocks_list);
	}
		
	var stocksToOpenPerClick = document.getElementById("stocksToOpenPerClick").value;
	messageProcessedStocks.innerHTML = strStockProcessed;	
	
	if (jsonFormat.checked == true) {
		totalStocks = jsonData.data.length;
		debugger;
		for (i = processedStocks ; i < totalStocks ; i++) {
			debugger;
			strStockProcessed += jsonData.data[i].symbol;
			strStockProcessed += ", ";
			openPage(jsonData.data[i].symbol)
			debugger;
			processedStocks += 1
			if (processedStocks % stocksToOpenPerClick == 0)
				break;
		}
		messageProcessedStocks.innerHTML = strStockProcessed;
	} else {
		debugger;
		var stocks_list = document.getElementById("stockTicker").value;
		txtSeperatorSpace = document.getElementById("txtSeperatorSpace");
		if(txtSeperatorSpace.checked == true) {
			seperator = " ";
		} else {
			seperator = ",";
		}
		var stocks = stocks_list.split(seperator)
		totalStocks = stocks.length - 1;
		for (i = processedStocks ; i < stocks.length -1; i++) {
			debugger;
			strStockProcessed += stocks[i];
			strStockProcessed += ", ";
			openPage(stocks[i]);
			processedStocks += 1
			if (processedStocks % stocksToOpenPerClick == 0)
				break;
		}
		messageProcessedStocks.innerHTML = strStockProcessed;
	}
	messageProcessedStocksStats.innerHTML = "Total stocks: " + totalStocks + " Processed: " + processedStocks
}
</script>
</body>
</html>
